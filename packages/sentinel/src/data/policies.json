[
    {
        "id": "policy-1",
        "description": "Admins have full access to all resources",
        "actions": [
            "*"
        ],
        "rbac": {
            "anyRole": [
                "admin"
            ]
        }
    },
    {
        "id": "policy-2",
        "description": "Users can read their own documents",
        "actions": [
            "document:read"
        ],
        "rbac": {
            "anyRole": [
                "user"
            ]
        },
        "abac": {
            "and": [
                {
                    "===": [
                        {
                            "var": "resource.type"
                        },
                        "document"
                    ]
                },
                {
                    "===": [
                        {
                            "var": "resource.ownerId"
                        },
                        {
                            "var": "subject.sub"
                        }
                    ]
                }
            ]
        }
    },
    {
        "id": "policy-3",
        "description": "Users can create documents",
        "actions": [
            "document:create"
        ],
        "rbac": {
            "anyRole": [
                "user"
            ]
        },
        "abac": {
            "===": [
                {
                    "var": "resource.type"
                },
                "document"
            ]
        }
    },
    {
        "id": "policy-4",
        "description": "Users can update their own documents",
        "actions": [
            "document:update"
        ],
        "rbac": {
            "anyRole": [
                "user"
            ]
        },
        "abac": {
            "and": [
                {
                    "===": [
                        {
                            "var": "resource.type"
                        },
                        "document"
                    ]
                },
                {
                    "===": [
                        {
                            "var": "resource.ownerId"
                        },
                        {
                            "var": "subject.sub"
                        }
                    ]
                }
            ]
        }
    },
    {
        "id": "policy-5",
        "description": "Users can delete their own documents",
        "actions": [
            "document:delete"
        ],
        "rbac": {
            "anyRole": [
                "user"
            ]
        },
        "abac": {
            "and": [
                {
                    "===": [
                        {
                            "var": "resource.type"
                        },
                        "document"
                    ]
                },
                {
                    "===": [
                        {
                            "var": "resource.ownerId"
                        },
                        {
                            "var": "subject.sub"
                        }
                    ]
                }
            ]
        }
    },
    {
        "id": "policy-6",
        "description": "Managers can read all documents",
        "actions": [
            "document:read"
        ],
        "rbac": {
            "anyRole": [
                "manager"
            ]
        },
        "abac": {
            "===": [
                {
                    "var": "resource.type"
                },
                "document"
            ]
        }
    },
    {
        "id": "policy-7",
        "description": "Managers can update documents in their department",
        "actions": [
            "document:update"
        ],
        "rbac": {
            "anyRole": [
                "manager"
            ]
        },
        "abac": {
            "and": [
                {
                    "===": [
                        {
                            "var": "resource.type"
                        },
                        "document"
                    ]
                },
                {
                    "in": [
                        {
                            "var": "resource.departmentId"
                        },
                        {
                            "var": "subject.departmentIds"
                        }
                    ]
                }
            ]
        }
    },
    {
        "id": "policy-8",
        "description": "Users can list documents in their department",
        "actions": [
            "document:list"
        ],
        "rbac": {
            "anyRole": [
                "user"
            ]
        },
        "abac": {
            "in": [
                {
                    "var": "resource.departmentId"
                },
                {
                    "var": "subject.departmentIds"
                }
            ]
        }
    },
    {
        "id": "policy-9",
        "description": "Users can view public resources",
        "actions": [
            "resource:view"
        ],
        "rbac": {
            "anyRole": [
                "user"
            ]
        },
        "abac": {
            "and": [
                {
                    "===": [
                        {
                            "var": "resource.type"
                        },
                        "resource"
                    ]
                },
                {
                    "===": [
                        {
                            "var": "resource.visibility"
                        },
                        "public"
                    ]
                }
            ]
        }
    },
    {
        "id": "policy-10",
        "description": "Managers can create resources",
        "actions": [
            "resource:create"
        ],
        "rbac": {
            "anyRole": [
                "manager"
            ]
        },
        "abac": {
            "===": [
                {
                    "var": "resource.type"
                },
                "resource"
            ]
        }
    }
]